<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://jeanoskii.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://jeanoskii.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2026-01-17T14:33:31+00:00</updated><id>https://jeanoskii.github.io/feed.xml</id><title type="html">blank</title><subtitle>Personal website, project portfolio, and blog with topics on cybersecurity and computers. </subtitle><entry><title type="html">Reversing an Attempt at Obfuscation</title><link href="https://jeanoskii.github.io/blog/2026/reversing-obfuscation/" rel="alternate" type="text/html" title="Reversing an Attempt at Obfuscation"/><published>2026-01-17T00:00:00+00:00</published><updated>2026-01-17T00:00:00+00:00</updated><id>https://jeanoskii.github.io/blog/2026/reversing-obfuscation</id><content type="html" xml:base="https://jeanoskii.github.io/blog/2026/reversing-obfuscation/"><![CDATA[<p>In 2015, during a random work day, I was talking with a good friend of mine about programming. We were figuring out which one of us is better, by exchanging challenges back and forth about software engineering. I defeated all his challenges, but he then brought out his hardest one yet. It wasn’t about engineering anymore, but the opposite. He sent me a Java file and told me to describe to him its logic. Here’s the code that he sent me and I’ll let you guess what is happening:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>package com.cerberus.core;

import java.math.BigInteger;
import android.support.v4.view.MotionEventCompat;

public class CerberusUtil {
    public static final String APP = rev3753("/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:1/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:0/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:0");
    public static final String DEV = rev3753("/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:9/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:0/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:8/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:0/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:1/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:0/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:8/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:9/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:1");
    public static final String PACKAGE = rev3753("/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5");

    public static String bytesToHex(byte[] bArray) {
        byte[] bArray1 = bArray;
        char[] chArray = new char[(bArray1.length * 2)];
        for (int i = 0; i &lt; bArray1.length; i++) {
            int j = bArray1[i] &amp; MotionEventCompat.ACTION_MASK;
            chArray[i * 2] = hexArray[j &gt;&gt;&gt; 4];
            chArray[(i * 2) + 1] = hexArray[j &amp; 15];
        }
        String s = r11;
        String s2 = new String(chArray);
        return s;
    }

    public static final String rev3753(String s) {
        String decode = decode(decode(decode(decode(decode(decode(decode(s.replace("?", "4").replace("%", "f").replace(":", "3").replace("-", "d").replace("/", "2")).replace("-", "3").replace("/", "6")))).replace("-", "3").replace("/", "6"))));
        return r0;
    }

    public static final String rev3854(String s) {
        BigInteger bigInteger1 = r13;
        BigInteger bigInteger2 = new BigInteger(s.getBytes());
        String bigInteger3 = bigInteger1.toString(16);
        bigInteger1 = r13;
        bigInteger2 = new BigInteger(bigInteger3.getBytes());
        String bigInteger4 = bigInteger1.toString(16);
        bigInteger1 = r13;
        bigInteger2 = new BigInteger(bigInteger4.getBytes());
        String replace = bigInteger1.toString(16).replace("3", "-").replace("6", "/");
        bigInteger1 = r13;
        bigInteger2 = new BigInteger(replace.getBytes());
        String bigInteger5 = bigInteger1.toString(16);
        bigInteger1 = r13;
        bigInteger2 = new BigInteger(bigInteger5.getBytes());
        String bigInteger6 = bigInteger1.toString(16);
        bigInteger1 = r13;
        bigInteger2 = new BigInteger(bigInteger6.getBytes());
        String replace2 = bigInteger1.toString(16).replace("3", "-").replace("6", "/");
        bigInteger1 = r13;
        bigInteger2 = new BigInteger(replace2.getBytes());
        String replace3 = bigInteger1.toString(16).replace("4", "?").replace("f", "%").replace("3", ":").replace("d", "-").replace("2", "/");
        return r0;
    }

    public static final String decode(String s) {
        String s2 = s;
        StringBuilder sb = r13;
        StringBuilder sb2 = new StringBuilder();
        StringBuilder sb3 = sb;
        sb = r13;
        sb2 = new StringBuilder();
        StringBuilder sb4 = sb;
        StringBuilder sb5 = sb3;
        for (int i = 0; i &lt; r2.length() - 1; i += 2) {
            sb3 = sb5.append((char) Integer.parseInt(r2.substring(i, i + 2), 16));
        }
        return sb5.toString();
    }

    public CerberusUtil() {
        CerberusUtil cbUtil = this;
    }
}
</code></pre></div></div> <p>Wow. That’s a lot to take in. But I’ll be going over each part of the code and explain what’s happening. Let’s establish some goals first.</p> <p>One of the first steps in reverse engineering is to set goals—<em>What are we doing and <strong>why</strong>?</em> By identifying our goals, we get a clearer picture about the purpose and intention of the task at hand. This also helps us determine the expected outcomes, as well as the success factors. So I asked my friend: <em>what do you want to know or get done?</em> He wants me to describe what is being done by the program. I then asked: <em>is there a specific part of the program you want to understand?</em> He said he wants to know what the long strings <code class="language-plaintext highlighter-rouge">/-/-/...</code> were. By asking these questions, we now know the goal of the reverse engineering task. We can now begin dissecting the code.</p> <p>Looking at the code, I immediately noticed the <code class="language-plaintext highlighter-rouge">/-/-/...</code> strings he was referring to (who wouldn’t, it took up a lot of screen space). Obviously, this looks like a case of obfuscation. I also noticed that it has an import statement referring to an Android package. This file must be from an Android app, I figured. I confirmed my hunch because the code has references for <code class="language-plaintext highlighter-rouge">r0</code>, <code class="language-plaintext highlighter-rouge">r11</code>, <code class="language-plaintext highlighter-rouge">r13</code>, and <code class="language-plaintext highlighter-rouge">r2</code>; these are placeholder names for registers when the APK is decompiled. I asked my friend where the file came from, and my hunch was correct. He said that the Java file he sent came from decompiling an APK file using <a href="https://bytecodeviewer.com/">Bytecode Viewer</a>. He created an Android app long ago, but lost access to the source code. So he used Bytecode Viewer in hopes of recovering the code. However, he doesn’t remember what the <code class="language-plaintext highlighter-rouge">/-/-/...</code> was all about.</p> <p>Now we know it is a Java file, from an Android app. Next, let’s identify more facts by looking close at the code. We can see that it has the following components:</p> <ul> <li>1 class named <code class="language-plaintext highlighter-rouge">CerberusUtil</code></li> <li>3 string constants named <code class="language-plaintext highlighter-rouge">APP</code>, <code class="language-plaintext highlighter-rouge">DEV</code>, and <code class="language-plaintext highlighter-rouge">PACKAGE</code></li> <li>4 functions named <code class="language-plaintext highlighter-rouge">bytesToHex</code>, <code class="language-plaintext highlighter-rouge">rev3753</code>, <code class="language-plaintext highlighter-rouge">rev3854</code>, and <code class="language-plaintext highlighter-rouge">decode</code></li> <li>1 default constructor</li> </ul> <p>Before we move forward, let us remind ourselves of the objective: The goal was to uncover what the <code class="language-plaintext highlighter-rouge">/-/-/...</code> strings were. Therefore, our investigation will start with the string constants <code class="language-plaintext highlighter-rouge">APP</code>, <code class="language-plaintext highlighter-rouge">DEV</code>, and <code class="language-plaintext highlighter-rouge">PACKAGE</code>. Each of these string constants feed the <code class="language-plaintext highlighter-rouge">/-/-/...</code> strings as parameter to the <code class="language-plaintext highlighter-rouge">rev3753</code> function, so that’s where we’re going next.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static final String rev3753(String s) {
    String decode = decode(decode(decode(decode(decode(decode(decode(s.replace("?", "4").replace("%", "f").replace(":", "3").replace("-", "d").replace("/", "2")).replace("-", "3").replace("/", "6")))).replace("-", "3").replace("/", "6"))));
    return r0;
}
</code></pre></div></div> <p>Taking a look at <code class="language-plaintext highlighter-rouge">rev3753</code> function, we can see that it accepts a string parameter, but also returns or outputs a string as well. Inside the function, we have a string called decode, which is equal to the output of multiple <code class="language-plaintext highlighter-rouge">decode</code> functions. In total, there are 7 nested <code class="language-plaintext highlighter-rouge">decode</code> functions. Since the original code is formatted poorly, removing any whitespaces and newlines, let’s make it more readable.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static final String rev3753(String s) {
    String decode = 
        decode(
            decode(
                decode(
                    decode(
                        decode(
                            decode(
                                decode(
                                    s.replace("?", "4")
                                    .replace("%", "f")
                                    .replace(":", "3")
                                    .replace("-", "d")
                                    .replace("/", "2")
                                )
                                .replace("-", "3")
                                .replace("/", "6")
                            )
                        )
                    )
                    .replace("-", "3")
                    .replace("/", "6")
                )
            )
        );
    return r0;
}
</code></pre></div></div> <p>Looks better; we can now understand how each <code class="language-plaintext highlighter-rouge">decode</code> function works, more specifically what input is used in the first function and what output gets fed to the next function and so on. We know that the parameter for the <code class="language-plaintext highlighter-rouge">rev3753</code> are the <code class="language-plaintext highlighter-rouge">/-/-/...</code> strings, and we can see that the <code class="language-plaintext highlighter-rouge">s</code> parameter is used in the inner-most <code class="language-plaintext highlighter-rouge">replace</code> functions. In other words, we are replacing <code class="language-plaintext highlighter-rouge">?, %, :, -, /</code> in the <code class="language-plaintext highlighter-rouge">/-/-/...</code> strings with <code class="language-plaintext highlighter-rouge">4, f, 3, d, 2</code> respectively. We are going to use the first constant, <code class="language-plaintext highlighter-rouge">APP</code>, in the succeeding parts, since we will determine the algorithm used to reverse the process anyways; It will work on both <code class="language-plaintext highlighter-rouge">DEV</code> and <code class="language-plaintext highlighter-rouge">PACKAGE</code> too.</p> <p>The <code class="language-plaintext highlighter-rouge">APP</code> string is:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-/%/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-://-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:5/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:1/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:0/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:7/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-://-/%/-:?/-/-/-/-/-/-/-:0
</code></pre></div></div> <p>After we replace the characters, we get:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d2f2d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d352d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d372d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d322d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d2f2d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d322d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d2f2d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d352d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d372d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d322d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d372d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d352d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d372d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d312d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d372d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d302d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d372d2d2d322d2f2d342d2d2d322d2f2d342d2d2d322d2f2d342d2d2d2d2d2d2d30
</code></pre></div></div> <p>We still don’t understand it, but that’s okay. We are going to feed this text to the <code class="language-plaintext highlighter-rouge">decode</code> function as described below:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static final String decode(String s) {
    String s2 = s;
    StringBuilder sb = r13;
    StringBuilder sb2 = new StringBuilder();
    StringBuilder sb3 = sb;
    sb = r13;
    sb2 = new StringBuilder();
    StringBuilder sb4 = sb;
    StringBuilder sb5 = sb3;
    for (int i = 0; i &lt; s2.length() - 1; i += 2) {
        sb3 = sb5.append((char) Integer.parseInt(s2.substring(i, i + 2), 16));
    }
    return sb5.toString();
}
</code></pre></div></div> <p>In the <code class="language-plaintext highlighter-rouge">decode</code> function, what we want to track is the <code class="language-plaintext highlighter-rouge">s</code> parameter. Observing the logic, we can remove the clutter, leaving us with:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static final String decode(String s) {
    String s2 = s;
    StringBuilder sb = new StringBuilder();
    StringBuilder sb3 = sb;
    StringBuilder sb5 = sb3;
    for (int i = 0; i &lt; s2.length() - 1; i += 2) {
        sb3 = sb5.append(
            (char)Integer.parseInt(
                s2.substring(i, i + 2),
                16)
            );
    }
    return sb5.toString();
}
</code></pre></div></div> <p>Now we can read it easier. First, the string <code class="language-plaintext highlighter-rouge">s</code> is assigned to string <code class="language-plaintext highlighter-rouge">s2</code>, which is then referenced in the <code class="language-plaintext highlighter-rouge">for</code> loop. Looking at the <code class="language-plaintext highlighter-rouge">for</code> loop, we can see that it goes through the length of the string in <strong>pairs</strong>, because the iterator increments by two (hence <code class="language-plaintext highlighter-rouge">i += 2</code>). This is a significant clue, as we also have a function named <code class="language-plaintext highlighter-rouge">bytesToHex</code> in the source file. We can infer that the <code class="language-plaintext highlighter-rouge">/-/-/...</code> string we are working on may contain <strong>hexadecimal</strong> values. By jumping into the <code class="language-plaintext highlighter-rouge">for</code> loop, we can see <code class="language-plaintext highlighter-rouge">Integer.parseInt</code> uses two parameters: <code class="language-plaintext highlighter-rouge">s2.substring(i, i + 2)</code>, and <code class="language-plaintext highlighter-rouge">16</code>. Referencing the Java <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html">documentation</a> reveals that this method is <code class="language-plaintext highlighter-rouge">parseInt(String s, int radix)</code> where the radix is the <strong>base</strong> of the original string. Since the value provided in the second parameter is <code class="language-plaintext highlighter-rouge">16</code>, meaning the radix is <strong>base-16</strong>, which therefore means the input string must be <strong>hexadecimal</strong>. Analysis confirmed! Now what? Well, the first parameter <code class="language-plaintext highlighter-rouge">s2.substring(i, i + 2)</code> effectively means to take two characters from string <code class="language-plaintext highlighter-rouge">s2</code> at current index. Putting both parameters together, our <code class="language-plaintext highlighter-rouge">Integer.parseInt</code> method takes two characters from string <code class="language-plaintext highlighter-rouge">s2</code> at the current index and converts it from <strong>hexadecimal</strong> to decimal, which is then casted to a corresponding <code class="language-plaintext highlighter-rouge">char</code> value in ASCII. This new <code class="language-plaintext highlighter-rouge">char</code> value is then appended to the StringBuilder <code class="language-plaintext highlighter-rouge">sb5</code>, then the <code class="language-plaintext highlighter-rouge">for</code> loop repeats until all characters in string <code class="language-plaintext highlighter-rouge">s</code> is converted. For the sake of brevity, here’s the step-by-step procedure for the <code class="language-plaintext highlighter-rouge">decode</code> function:</p> <ol> <li>Take input string (which is hexadecimal)</li> <li>Convert the hexadecimal string to decimal</li> <li>Convert the decimal to its ASCII equivalent</li> <li>Return value</li> </ol> <p>Applying this logic to our current value for <code class="language-plaintext highlighter-rouge">s</code> we get:</p> <h4 id="convert-the-hexadecimal-string-to-decimal">Convert the hexadecimal string to decimal</h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4545455045474552454545504547455245454550454745524545454545454552454545504547455245454550454745524545455045474552454545504547455245454550454745524545455045474552454545504547455245454550454745474545455045474552454545504547455245454550454745524545454545454553454545504547455245454550454745524545455045474552454545454545455545454550454745524545455045474552454545504547455245454545454545504545455045474552454545504547455245454550454745524545455045474547454545504547455245454550454745524545455045474552454545454545455045454550454745524545455045474552454545504547455245454550454745474545455045474552454545504547455245454550454745524545454545454553454545504547455245454550454745524545455045474552454545454545455545454550454745524545455045474552454545504547455245454545454545504545455045474552454545504547455245454550454745524545454545454555454545504547455245454550454745524545455045474552454545454545455345454550454745524545455045474552454545504547455245454545454545554545455045474552454545504547455245454550454745524545455045474552454545504547455245454550454745524545455045474552454545454545455245454550454745524545455045474552454545504547455245454545454545494545455045474552454545504547455245454550454745524545454545454555454545504547455245454550454745524545455045474552454545454545454845454550454745524545455045474552454545504547455245454545454545554545455045474552454545504547455245454550454745524545454545454548
</code></pre></div></div> <h4 id="convert-the-decimal-to-its-ascii-equivalent">Convert the decimal to its ASCII equivalent</h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---2-/-4---2-/-4---2-/-4-------4---2-/-4---2-/-4---2-/-4---2-/-4---2-/-4---2-/-4---2-/-4---2-/-/---2-/-4---2-/-4---2-/-4-------5---2-/-4---2-/-4---2-/-4-------7---2-/-4---2-/-4---2-/-4-------2---2-/-4---2-/-4---2-/-4---2-/-/---2-/-4---2-/-4---2-/-4-------2---2-/-4---2-/-4---2-/-4---2-/-/---2-/-4---2-/-4---2-/-4-------5---2-/-4---2-/-4---2-/-4-------7---2-/-4---2-/-4---2-/-4-------2---2-/-4---2-/-4---2-/-4-------7---2-/-4---2-/-4---2-/-4-------5---2-/-4---2-/-4---2-/-4-------7---2-/-4---2-/-4---2-/-4---2-/-4---2-/-4---2-/-4---2-/-4-------4---2-/-4---2-/-4---2-/-4-------1---2-/-4---2-/-4---2-/-4-------7---2-/-4---2-/-4---2-/-4-------0---2-/-4---2-/-4---2-/-4-------7---2-/-4---2-/-4---2-/-4-------0
</code></pre></div></div> <p>We can now cross out the first <code class="language-plaintext highlighter-rouge">decode</code> function:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">decode(
</span>    decode(
        decode(
            decode(
                decode(
                    decode(
<span class="gd">-                        decode(
-                            s.replace("?", "4")
-                            .replace("%", "f")
-                            .replace(":", "3"
-                            .replace("-", "d")
-                            .replace("/", "2")
-                        )
</span>                        .replace("-", "3")
                        .replace("/", "6")
                    )
                )
            )
            .replace("-", "3")
            .replace("/", "6")
        )
    )
);
</code></pre></div></div> <p>6 more to go!</p> <p>For the next <code class="language-plaintext highlighter-rouge">decode</code> function, before it executes it must first replace the previous characters <code class="language-plaintext highlighter-rouge">-, /</code> with <code class="language-plaintext highlighter-rouge">3, 6</code> respectively. Our string would now be:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>33323634333236343332363433333334333236343332363433323634333236343332363433323634333236343332363633323634333236343332363433333335333236343332363433323634333333373332363433323634333236343333333233323634333236343332363433323636333236343332363433323634333333323332363433323634333236343332363633323634333236343332363433333335333236343332363433323634333333373332363433323634333236343333333233323634333236343332363433333337333236343332363433323634333333353332363433323634333236343333333733323634333236343332363433323634333236343332363433323634333333343332363433323634333236343333333133323634333236343332363433333337333236343332363433323634333333303332363433323634333236343333333733323634333236343332363433333330
</code></pre></div></div> <p>As with the previous step, this new (hexadecimal) string will be converted to decimal, and finally to an ASCII character array:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3264326432643334326432643264326432643264326432663264326432643335326432643264333732643264326433323264326432643266326432643264333232643264326432663264326432643335326432643264333732643264326433323264326432643337326432643264333532643264326433373264326432643264326432643264333432643264326433313264326432643337326432643264333032643264326433373264326432643330
</code></pre></div></div> <p>Now that’s the 6th <code class="language-plaintext highlighter-rouge">decode</code> function done and dusted:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">decode(
</span>    decode(
        decode(
            decode(
                decode(
<span class="gd">-                    decode(
-                        decode(
-                            s.replace("?", "4")
-                            .replace("%", "f")
-                            .replace(":", "3"
-                            .replace("-", "d")
-                            .replace("/", "2")
-                        )
-                        .replace("-", "3")
-                        .replace("/", "6")
-                    )
</span>                )
            )
            .replace("-", "3")
            .replace("/", "6")
        )
    )
);
</code></pre></div></div> <p>The next two <code class="language-plaintext highlighter-rouge">decode</code> functions are executed one after the other, where the output of the former is the input to the latter. No character replace here. So let’s just take our current value and put it to the <code class="language-plaintext highlighter-rouge">decode</code> function <strong>twice</strong>. Thus, we have:</p> <h4 id="first-iteration-of-decode">First iteration of <code class="language-plaintext highlighter-rouge">decode</code></h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2d2d2d342d2d2d2d2d2d2d2f2d2d2d352d2d2d372d2d2d322d2d2d2f2d2d2d322d2d2d2f2d2d2d352d2d2d372d2d2d322d2d2d372d2d2d352d2d2d372d2d2d2d2d2d2d342d2d2d312d2d2d372d2d2d302d2d2d372d2d2d30
</code></pre></div></div> <h4 id="second-iteration-of-decode">Second iteration of <code class="language-plaintext highlighter-rouge">decode</code></h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---4-------/---5---7---2---/---2---/---5---7---2---7---5---7-------4---1---7---0---7---0
</code></pre></div></div> <p>Much more manageable now. That’s two <code class="language-plaintext highlighter-rouge">decode</code> functions done:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">decode(
</span>    decode(
        decode(
<span class="gd">-            decode(
-                decode(
-                    decode(
-                        decode(
-                            s.replace("?", "4")
-                            .replace("%", "f")
-                            .replace(":", "3"
-                            .replace("-", "d")
-                            .replace("/", "2")
-                        )
-                        .replace("-", "3")
-                        .replace("/", "6")
-                    )
-                )
-            )
</span>            .replace("-", "3")
            .replace("/", "6")
        )
    )
);
</code></pre></div></div> <p>Now we have to replace <code class="language-plaintext highlighter-rouge">-, /</code> with <code class="language-plaintext highlighter-rouge">3, 6</code> again:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3334333333363335333733323336333233363335333733323337333533373333333433313337333033373330
</code></pre></div></div> <p>Then, run this string through our <code class="language-plaintext highlighter-rouge">decode</code> function thrice (again, hex → decimal → ASCII):</p> <h4 id="first-iteration-of-decode-1">First iteration of <code class="language-plaintext highlighter-rouge">decode</code></h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>34333635373236323635373237353733343137303730
</code></pre></div></div> <h4 id="second-iteration-of-decode-1">Second iteration of <code class="language-plaintext highlighter-rouge">decode</code></h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4365726265727573417070
</code></pre></div></div> <h4 id="final-iteration-of-decode">Final iteration of <code class="language-plaintext highlighter-rouge">decode</code></h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CerberusApp
</code></pre></div></div> <p>Voila! We have our decoded <code class="language-plaintext highlighter-rouge">APP</code> string. We’ve gone over every step in the <code class="language-plaintext highlighter-rouge">rev3753</code> function. In total, there were 7 nested <code class="language-plaintext highlighter-rouge">decode</code> functions:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-decode(
-    decode(
-        decode(
-            decode(
-                decode(
-                    decode(
-                        decode(
-                            s.replace("?", "4")
-                            .replace("%", "f")
-                            .replace(":", "3"
-                            .replace("-", "d")
-                            .replace("/", "2")
-                        )
-                        .replace("-", "3")
-                        .replace("/", "6")
-                    )
-                )
-            )
-            .replace("-", "3")
-            .replace("/", "6")
-        )
-    )
-);
</span></code></pre></div></div> <p>One after the after, we went over each function call, taking note the input and the output. And as you can notice, we removed all the unnecessary stuff from being examined. This is because the first step is establishing the objectives. With a clear goal, we were able to narrow down the specific, lucrative parts of the code to analyze—we didn’t even look into the <code class="language-plaintext highlighter-rouge">rev3854</code> function! What we essentially did was reverse engineering! With the knowledge of the algorithm, I wrote a JSFiddle:</p> <script async="" src="//jsfiddle.net/tumyda3q/embed/js,result/"></script> <p>So I sent the results to my friend, and I beat his challenge. We both won in the end though: I sharpened my skills in static analysis, and he gets back his source code. Win-win!</p> <p>These kinds of challenges are popular on the internet: crack.me, hack.me, keygen.me, etc. We might do another one in the future!</p>]]></content><author><name></name></author><category term="ethical-hacking"/><category term="reverse-engineering"/><category term="retrospective"/><category term="obfuscation"/><category term="java"/><category term="static-analysis"/><summary type="html"><![CDATA[In other words, reverse engineering]]></summary></entry><entry><title type="html">I downloaded malware! Now what?</title><link href="https://jeanoskii.github.io/blog/2026/wazuh-virustotal/" rel="alternate" type="text/html" title="I downloaded malware! Now what?"/><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>https://jeanoskii.github.io/blog/2026/wazuh-virustotal</id><content type="html" xml:base="https://jeanoskii.github.io/blog/2026/wazuh-virustotal/"><![CDATA[<p>In my <a href="/blog/2026/wazuh-install">previous</a> blog post, I alluded to Wazuh being both a SIEM and an XDR. I specifically mentioned that VirusTotal can be integrated into Wazuh for file integrity monitoring. Today, we’ll be discussing how I enabled VirusTotal integration in Wazuh.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-14/VirusTotal-480.webp 480w,/assets/img/posts/2026-01-14/VirusTotal-800.webp 800w,/assets/img/posts/2026-01-14/VirusTotal-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/posts/2026-01-14/VirusTotal.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>But what’s <a href="https://www.virustotal.com/">VirusTotal</a>? It is a free online service that analyzes files, URLs, IP addresses, and domains for malware. VirusTotal works with antivirus scanners and URL/domain blocklisting services to intelligently inspect anything you upload to its web interface. In addition, when a user scans an object, the results are aggregated in a global repository, thereby making a contribution to worldwide cybersecurity efforts. This is an extremely useful tool for any cybersecurity professional!</p> <p>Now that you know how important VirusTotal is, let’s get to configuring it! But let us recall first our infrastructure:</p> <pre><code class="language-mermaid">flowchart LR
    subgraph "Windows Desktop"
        A[Wazuh Agent]
        subgraph "VirtualBox"
            subgraph "Ubuntu Virtual Machine"
                B[Wazuh Server]
            end
            subgraph "Ubuntu Virtual Machine"
                C[Wazuh Agent]
            end
        end
    end
    subgraph "Windows Laptop"
        D[Wazuh Agent]
    end
    B --&gt;|Monitors| A
    B --&gt;|Monitors| C
    B --&gt;|Monitors| D
</code></pre> <p>As you can see, we have two physical machines running Windows, and two Ubuntu virtual machines. Our Wazuh server is installed in one of the Ubuntu VMs, while the rest have Wazuh agents (a.k.a. endpoints).</p> <p>I followed Wazuh’s <a href="https://documentation.wazuh.com/current/proof-of-concept-guide/detect-remove-malware-virustotal.html">Proof of Concept guide</a> for detecting and removing malware using VirusTotal integration. In this guide, three files will be referenced multiple times:</p> <ul> <li>ossec.conf</li> <li>local_rules.xml</li> <li>remove-threat.sh / remove-threat.exe</li> </ul> <p>Depending on the operating system, the <code class="language-plaintext highlighter-rouge">ossec.conf</code> file can be found in <code class="language-plaintext highlighter-rouge">C:\Program Files (x86)\ossec-agent\</code> for Windows; and under Ubuntu it can be found in <code class="language-plaintext highlighter-rouge">/var/ossec/etc/</code>. We will be modifying the configuration file for both the Wazuh server and the Wazuh agents. Whereas the <code class="language-plaintext highlighter-rouge">local_rules.xml</code> will be modified on the Wazuh server only, which can be found in <code class="language-plaintext highlighter-rouge">/var/ossec/etc/rules</code> directory. Lastly, the <code class="language-plaintext highlighter-rouge">remove-threat</code> file is the active response script provided by Wazuh, so we don’t need to write it ourselves. We are free to modify the script to fit our environment, but for this home lab, it works out of the box.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-14/wazuh-localrules.PNG" sizes="95vw"/> <img src="/assets/img/posts/2026-01-14/wazuh-localrules.PNG" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-14/wazuh-osseconf-windows.PNG" sizes="95vw"/> <img src="/assets/img/posts/2026-01-14/wazuh-osseconf-windows.PNG" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-14/wazuh-removethreat-windows.PNG" sizes="95vw"/> <img src="/assets/img/posts/2026-01-14/wazuh-removethreat-windows.PNG" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>We must also be familiar with the software we will be using, primarily, the use terminal and Powershell commands. I exclusively used the command-line interface to set up the VirusTotal integration, except for in Windows where I had to open Notepad to edit text files and and install Python using the installer GUI.</p> <p>After becoming familiar with the files and tools needed, we can proceed to follow the guide. I first set up the endpoints, both Ubuntu and Windows. Afterwards, I configured the Wazuh server on the Ubuntu VM. Then, I downloaded an EICAR file on both agents. What’s an <a href="https://www.eicar.org/download-anti-malware-testfile/">EICAR file</a> you ask? An EICAR file is used to test the detection capability of an antivirus software. Once I downloaded the EICAR files, hits began showing up on the dashboard.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-14/wazuh-virustotal-hit.PNG" sizes="95vw"/> <img src="/assets/img/posts/2026-01-14/wazuh-virustotal-hit.PNG" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>As you can see, Wazuh was able to detect that the EICAR file was added on the endpoint. That’s when VirusTotal kicks in. Wazuh integrates VirusTotal for File Integrity Monitoring (FIM), meaning, the EICAR file will be sent to VirusTotal for scanning. A VirusTotal alert gets outputted, therefore flagging the file as malicious.</p> <p>The title of this blog post is “I downloaded malware! Now what?” The answer is: Wazuh <strong>deletes</strong> the malicious file. Automatically! Without user intervention! That’s the beauty of active response. With a SIEM like Wazuh, we can integrate detection and response functionalities, allowing seamless removal of files on the endpoints while flagging an alert in the server. This is why Wazuh is both a SIEM and an XDR.</p> <p>With that, we have successfully configured VirusTotal, simulated an attack, and visualized an alert in Wazuh. This splendid software has more to offer though, so we might be seeing each other again soon.</p> <p>Until next time!</p>]]></content><author><name></name></author><category term="cybersecurity"/><category term="software"/><category term="linux"/><category term="wazuh"/><category term="virustotal"/><category term="malware"/><category term="xdr"/><category term="edr"/><category term="ubuntu"/><summary type="html"><![CDATA[Enabling active detection and response capabilities in Wazuh with VirusTotal]]></summary></entry><entry><title type="html">Watch me on Youtube</title><link href="https://jeanoskii.github.io/blog/2026/tutorials/" rel="alternate" type="text/html" title="Watch me on Youtube"/><published>2026-01-11T21:01:00+00:00</published><updated>2026-01-11T21:01:00+00:00</updated><id>https://jeanoskii.github.io/blog/2026/tutorials</id><content type="html" xml:base="https://jeanoskii.github.io/blog/2026/tutorials/"><![CDATA[<p>A favorite pastime of mine is watching video essays about niche topics related to computing. A few examples would be: <a href="https://www.youtube.com/watch?v=dnHdqPBrtH8">Why the Soviet Computer Failed</a>, <a href="https://www.youtube.com/watch?v=BUCZJWo9MZo">Man and Computer: A Perspective</a>, and <a href="https://www.youtube.com/watch?v=54CyHBI1d6Y">Xerox - The Company That Threw Away Everything</a>. I like the idea of feeding my brain with obscure information. Eventually, this habit would pay off while I was lecturing for STI. During class, I would refer to these bizarre examples, often to the astoundment of the students.</p> <p>The other night, I was watching a video essay on <a href="https://www.youtube.com/watch?v=MBHX3NvRARc">ThinkPad – The Story of the World’s Most Famous Laptop</a>. A memory came flashing back—I used to do this! I was making Youtube videos before, albeit of low production quality. Although, my content creation strategy was primarily driven either by a course requirement, or as supplementary teaching materials.</p> <p>So let’s take a trip down memory lane!</p> <p>2016—our journey begins here. This was the year when I first started working in a corporate job, and it was also the year I enrolled in graduate studies. The very first video that I made was about computer ethics, with a title of <a href="https://www.youtube.com/watch?v=c3qxRpnPgYE">Is CSGO Gambling Ethical?</a> Back then, gambling became infamous in the computer game Counter-Strike: Global Offensive, with some gaming influencers often advertising betting websites in their streams. This video explored the ethical concerns surrounding the promotion of gambling sites within a game played by a wide audience, including children, teenagers, and individuals who may be financially vulnerable.</p> <div class="embed-responsive embed-responsive-16by9 mb-3"> <figure> <iframe src="https://www.youtube.com/embed/c3qxRpnPgYE" class="embed-responsive-item rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"/> </figure> </div> <p>The second video was about database normalization. In this video, the first to fifth normal forms were discussed, along with examples. I opted for a more academic but engaging approach to this video, unlike the previous video. This was part of a group activity, so I volunteered to create the video while the others worked on the content. Upon receiving the initial draft of the script, it took me 20 minutes. In my mind, who wants to watch 20 minutes? I looked for similar explainer-type videos, and their approach was to explain a topic within a time limit, usually 5 or 10 minutes. I took this inspiration and modified the script to reach 10 minutes instead. After a few recording and editing sessions, the video was published to our class. The instructor, and our classmates, loved our work! From the comments we got, the consensus was that we were able to take a difficult topic yet discuss it concisely and engagingly as possible.</p> <div class="embed-responsive embed-responsive-16by9 mb-3"> <figure> <iframe src="https://www.youtube.com/embed/v3N5PlbUHTs" class="embed-responsive-item rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"/> </figure> </div> <p>The year is now 2017. I passed the first semester of my graduate studies, and I well on my way to the second semester. I was enrolled in the course Advanced Computer Systems. I thought this was going to be a boring subject, but our professor had other plans. The laboratory activities are both tedious, yet enjoyable. He had us explore <a href="https://samsungtizenos.com/">Tizen OS</a> and create a simple application—talk about obscure! Going back to the video, the assigned topic was concurrency. This time, I imitated the style of <a href="https://www.youtube.com/user/Vsauce">Vsauce</a>. I’m a big fan of Vsauce and their approach to content creation. I had fun finding funny but related GIFs to insert in the video, especially the one at <a href="https://youtu.be/_pJCXxcX_r0?t=106">1:46</a> of the video.</p> <div class="embed-responsive embed-responsive-16by9 mb-3"> <figure> <iframe src="https://www.youtube.com/embed/_pJCXxcX_r0" class="embed-responsive-item rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"/> </figure> </div> <p>The next video was a tutorial on how to inject DLLs, make windows unclosable, and decompile Visual Basic code. I know, that’s a lot. Please bear with me, as this video is over 15 minutes long, and full of jargon. For this video, since the requirement is to demonstrate the practical use of reverse engineering tools (and I had little time), I was not able to structure the video in any creative way. The video is just me, sharing my screen, and doing <a href="https://legend.octopuslabs.io/">R4ndom’s Beginning Reverse Engineering Tutorials</a>. This was my first foray into reverse engineering, and using tools such as RadASM, OllyDbg, and ILSpy.</p> <div class="embed-responsive embed-responsive-16by9 mb-3"> <figure> <iframe src="https://www.youtube.com/embed/08N5iRhtd70" class="embed-responsive-item rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"/> </figure> </div> <p>After I graduated my masters, content creation slowed down. It wasn’t until 2019 where I touched video editing software again. At the height of the pandemic, I was teaching at STI College Las Piñas. The current materials for my subjects wasn’t enough for me, I had to supplement it. Quizzes, assignments, and exams were adjusted to adapt to online learning modality. This included the way I approached lecturing. I had an opinion that an online class going over 3 hours is not conducive. Therefore, I recorded a sessions of myself explaining the topic, going over the software, what to do, what to click, etc. I then had students watch the video while doing the laboratory activity. This way, even if I’m not with them, the students can refer to the instructions in the video to accomplish the task. Mind you, not all students have access to a computer. I had to look for software that students can use with their existing devices (i.e. an Android phone).</p> <div class="embed-responsive embed-responsive-16by9 mb-3"> <figure> <iframe src="https://www.youtube.com/embed/ewNaKoSS4hg" class="embed-responsive-item rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"/> </figure> </div> <p>While creating this blog post, I rewatched my recordings; Feeling cringe but at the same time nostalgia. Some of the videos I made was for an academic requirement, while others for my students. I’d like to think that, for a while, the videos I made helped out a struggling student. And for me, that’s all I need to know.</p> <p>Should I go back to making videos? We shall see.</p>]]></content><author><name></name></author><category term="retrospective"/><category term="database"/><category term="ethics"/><category term="reverse-engineering"/><category term="operating-systems"/><summary type="html"><![CDATA[I made explainers and how-tos on reverse engineering, cyber ethics, and others.]]></summary></entry><entry><title type="html">What SIEMs to be the problem?</title><link href="https://jeanoskii.github.io/blog/2026/wazuh-install/" rel="alternate" type="text/html" title="What SIEMs to be the problem?"/><published>2026-01-08T21:00:00+00:00</published><updated>2026-01-08T21:00:00+00:00</updated><id>https://jeanoskii.github.io/blog/2026/wazuh-install</id><content type="html" xml:base="https://jeanoskii.github.io/blog/2026/wazuh-install/"><![CDATA[<p>Visibility. That’s the problem.</p> <p>Security Information and Event Management, or SIEM, is a comprehensive system that provides real-time analysis of security alerts. This is an essential tool for security operation centers (SOC), whereby data generated by endpoints can be collected, aggregated, and analyzed. In this post, we will talk about <a href="https://wazuh.com/">Wazuh</a> and my experiences in installing it.</p> <p>Why Wazuh? Primarily, it’s open-source. Second, the ease of installation. Lastly, the name has a cool ring to it—sounds like something you’ll hear on a kids movie.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-08/mike%20wazowski.webp" sizes="95vw"/> <img src="/assets/img/posts/2026-01-08/mike%20wazowski.webp" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Mike "Wazuh"wski </div> <p>Now that’s visibility! Just like how Wazuh is able to see endpoint alerts, plus the user can see into its <a href="https://github.com/wazuh/wazuh">code</a>.</p> <p>Before we dive deeper into Wazuh, let’s first discuss <em>what</em> to protect. We have already talked about what a SIEM is and why companies should have it on their SOC, but it is important to know how many devices (or assets) we have, and which ones to secure. In reality, most organizations have a lot of computers, some of which may have different operating systems and configurations. It is possible that SIEM agents may not be compatible with some of the workstations. In addition, some SIEMs may charge fees for exceeding a certain amount of endpoints, or even on a per-endpoint basis. This increases total cost of ownership. BUT, there’s Wazuh! With its open-source to security, Wazuh is available at no cost! Huzzah!</p> <p>For testing, we will be securing four machines: one desktop, one laptop, and two virtual machines. The physical machines run on Windows 10, and the virtual machines run on <strong>Ubuntu 20.04</strong> via VirtualBox. The Wazuh server will be deployed on one of the Ubuntu VMs, whereas the other machines will have Wazuh agents.</p> <pre><code class="language-mermaid">flowchart LR
    subgraph "Windows Desktop"
        A[Wazuh Agent]
        subgraph "VirtualBox"
            subgraph "Ubuntu Virtual Machine"
                B[Wazuh Server]
            end
            subgraph "Ubuntu Virtual Machine"
                C[Wazuh Agent]
            end
        end
    end
    subgraph "Windows Laptop"
        D[Wazuh Agent]
    end
    B --&gt;|Monitors| A
    B --&gt;|Monitors| C
    B --&gt;|Monitors| D
</code></pre> <p>The first thing to set up is the Wazuh server on our Ubuntu 20.04 VM. Assume that all commands here are run as root user. Since it will be running on a fresh install on Ubuntu 20.04, we need to update the packages to minimize bugs and dependency errors. This can be done by running <code class="language-plaintext highlighter-rouge">apt update</code> followed by <code class="language-plaintext highlighter-rouge">apt full-upgrade</code>. We need to install <strong>curl</strong> as well, by running <code class="language-plaintext highlighter-rouge">apt install curl</code>. We should be able to install Wazuh without much fuss.</p> <p>Wazuh has three central components: <a href="https://documentation.wazuh.com/current/installation-guide/wazuh-indexer/index.html">Wazuh indexer</a>, <a href="https://documentation.wazuh.com/current/installation-guide/wazuh-server/index.html">Wazuh server</a>, and <a href="https://documentation.wazuh.com/current/installation-guide/wazuh-dashboard/index.html">Wazuh dashboard</a>. These components will be installed, in order, on our Ubuntu 20.04 VM. Thankfully, the installation guides are straightforward. I was able to install these components without devolving into insanity. Seriously, it all took around 2 hours, with most slow downs due to Internet connection and occasional stuck processes.</p> <p>Now that the Wazuh server is up and running, next is to set a <strong>static IP</strong> address for the VM. When Wazuh agents are deployed, they will be connecting to the IP address of the Wazuh server. Therefore, dynamic IP address assignment via DHCP is not ideal. Under VirtualBox, I set the network adapter to bridged for the VM and took note of its MAC address. Next, I configured the DHCP settings on my router to set a static IP address on the MAC address of the VM. In this case, I used 192.168.1.125.</p> <p>Opening 192.168.1.125 will bring up the Wazuh login screen. Once logged in, we can now deploy our <a hred="https://documentation.wazuh.com/current/installation-guide/wazuh-agent/index.html">Wazuh agents</a>. From here, the setup will be GUI-based, where the requisite commands will be generated by the web interface. I just need to select the OS, enter the Wazuh server IP address and Wazuh agent name. I copied the commands and ran it on the endpoints. After initializing the Wazuh agent, I was able to see it on the Wazuh server.</p> <p>At this point, we have finished installing Wazuh. All that’s left is to explore its features, on which there are many. Expanding the hamburger, we get the following menus:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-08/wazuh-home.PNG" sizes="95vw"/> <img src="/assets/img/posts/2026-01-08/wazuh-home.PNG" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-08/wazuh-menu.PNG" sizes="95vw"/> <img src="/assets/img/posts/2026-01-08/wazuh-menu.PNG" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2026-01-08/wazuh-custom-dashboard.PNG" sizes="95vw"/> <img src="/assets/img/posts/2026-01-08/wazuh-custom-dashboard.PNG" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Lots to see and lots to click, but I got tired of reading documentation. So I searched for a guide on Youtube on setting a dashboard, and it lead me to MyDFIR’s <a href="https://www.youtube.com/watch?v=QrcAhd5P7xw">tutorial</a> on creating a custom dashboard. I noticed that in his guide, he used the description “data.virustotal” on one of his visualizations. Essentially, he created data table of the top 5 alerts related to <strong>VirusTotal</strong>. I looked into it, and realized the power of Wazuh. It has the ability of becoming an eXtended Detection and Response (XDR). By adding the necessary scripts, Wazuh can handle File Integrity Monitoring and automatically remove malicious files on the endpoints. It’s like running an antivirus software on the machine. This is something I need to try, but wow. Wazuh, you’re awesome!</p> <p>That concludes my experiences with Wazuh. Overall, I’m quite pleased and can’t wait to try out its other features. You’ll be hearing more about this tool on this blog.</p> <p>If you’d like to learn more, I suggest you watch John Hammond’s <a href="https://www.youtube.com/watch?v=7Gn1GY5CIxg">video</a> about Wazuh.</p>]]></content><author><name></name></author><category term="cybersecurity"/><category term="software"/><category term="linux"/><category term="installation"/><category term="wazuh"/><category term="ubuntu"/><summary type="html"><![CDATA[Experiences on installing Wazuh.]]></summary></entry><entry><title type="html">Hello, world!</title><link href="https://jeanoskii.github.io/blog/2026/first/" rel="alternate" type="text/html" title="Hello, world!"/><published>2026-01-06T21:01:00+00:00</published><updated>2026-01-06T21:01:00+00:00</updated><id>https://jeanoskii.github.io/blog/2026/first</id><content type="html" xml:base="https://jeanoskii.github.io/blog/2026/first/"><![CDATA[<p>Welcome to my blog, where I post just about computer stuff (mostly). My current interests are on computers, programming, cybersecurity, gaming, and of course teaching.</p> <p>First of all, why make a blog? I figured that a blog on my website would be the best avenue for me to share my thoughts, opinions, and experiences. Here, I have control of the content and the way I want to present them. But people might wonder: How about Facebook or X? Well, I am privacy-conscious. I have always limited my social media use. When I’m not chatting with my friends on Messenger, I’d be checking Facebook marketplace, and that’s it. As a matter of fact, the marketplace would be the primary reason I’m not deactivating my Facebook account yet; such good deals!</p> <p>Now let’s talk how I went about creating this blog.</p> <p>There are numerous ways one can create a blog nowadays, from dedicated blogging platforms to completely custom blogs. I’m too frugal to subscribe to popular blogging platforms, but I’m also too lazy to code a blog from scratch. Then I remembered <strong>Github Pages</strong>; I used it to teach pull-based development where my students forked my Github <a href="https://github.com/jeanoskii/Software-Design-Prefinal-Exam">repository</a> and appended their own entry into the <a href="https://jeanoskii.github.io/Software-Design-Prefinal-Exam/">site</a>.</p> <p>However, Github Pages only allows static websites—no Wordpress here! I had to look for a static site generator, narrowing down my choices to Astro, Hugo, and Jekyll. Each option uses different programming languages: Javascript, Go, and Ruby respectively (all of which I know little of). But I had to choose, and since Jekyll has built-in support for Github Pages, I went with <strong>Jekyll</strong>. This meant I had to brush up on my Ruby skills.</p> <p>During college, we had a course on web development where we created an application using plain Ruby and Ruby on Rails. But that memory is a bit hazy. At this point, my priority is to publish a blog, not learn Ruby <em>to</em> publish a blog. So I looked into Jekyll themes, coming up with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> and <a href="https://github.com/alshedivat/al-folio/">al-folio</a>. Both themes frequented my search, but the choice boiled down to which one has better documentation and community support. Having an easy to understand documentation meant that I can set up, configure, and run my blog just by reading the manual; and a good community meant that more people could help me fix my terrible code. Therefore, I went with <strong>al-folio</strong>.</p> <p>So the tech stack goes like this:</p> <pre><code class="language-mermaid">flowchart LR
    A(Github Pages) --&gt; B(Jekyll) --&gt; C(al-folio)
</code></pre> <p>With this setup, I can quickly create a website while pretending to be coding in VS Code!</p> <p>As 2025 was ending, I kept thinking to myself that I needed to build a personal website. As 2026 starts, here I am with a finished blog post. Here marks the first out of the many posts in this blog. I am eager to share my knowledge, findings, and ramblings, only here on Jeano’s Journal.</p>]]></content><author><name></name></author><category term="explainer"/><category term="blog"/><summary type="html"><![CDATA[My first blog post]]></summary></entry></feed>